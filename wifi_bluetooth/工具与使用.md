# 工具与使用  
[omnipeek](#omnipeek)  &emsp;&emsp;  [wireshark](#wireshark)  &emsp;&emsp;  [iperf](#iperf)    


## omnipeek  
### 过滤器    
#### 新建过滤器    
Omnipeek自带过滤器，如Beacon/Control/DATA/DHCP/ARP等。    
也可以建立自定义的过滤器，有simple/advanced两种方式。    
1.新建一个simple的filter，名字为test。Type默认为Simple，    
![simple的filter](https://github.com/gaheadus/daily_use/blob/master/Resources/%E6%96%B0%E5%BB%BA%E4%B8%80%E4%B8%AAsimple%E7%9A%84filter.png)    
2.新建一个advanced的filter，名字为test2。Type选择Advanced，    
![advanced的filter](https://github.com/gaheadus/daily_use/blob/master/Resources/%E6%96%B0%E5%BB%BA%E4%B8%80%E4%B8%AAadvanced%E7%9A%84filter.png)    
点击And或Or，创建第二个过滤条件，弹出对话框如下：    
![点击And或Or](https://github.com/gaheadus/daily_use/blob/master/Resources/%E7%82%B9%E5%87%BBAnd%E6%88%96Or.png)    
得到如下过滤器，    
![得到如下过滤器](https://github.com/gaheadus/daily_use/blob/master/Resources/%E5%BE%97%E5%88%B0%E5%A6%82%E4%B8%8B%E8%BF%87%E6%BB%A4%E5%99%A8.png)    
还可以设置否定条件，点击第二个条件，再点击Not按钮，得到第二个条件的否定条件，    
![还可以设置否定条件](https://github.com/gaheadus/daily_use/blob/master/Resources/%E8%BF%98%E5%8F%AF%E4%BB%A5%E8%AE%BE%E7%BD%AE%E5%90%A6%E5%AE%9A%E6%9D%A1%E4%BB%B6.png)    
[*返回omnipeek*](#omnipeek)    

#### 过滤器使用    
1.抓包的时候过滤    
抓包的时候选择某个过滤器，则只抓取符合过滤器条件的包；也可以不选择任何过滤器，则抓取空中的所有包。    
抓包的时候可以选择多个过滤器吗？待验证    

2.显示的时候过滤    
显示的时候选择某一个过滤器，则只显示符合过滤器条件的包。    
![择某一个过滤器](https://github.com/gaheadus/daily_use/blob/master/Resources/%E6%98%BE%E7%A4%BA%E7%9A%84%E6%97%B6%E5%80%99%E9%80%89%E6%8B%A9%E6%9F%90%E4%B8%80%E4%B8%AA%E8%BF%87%E6%BB%A4%E5%99%A8.png)    
选择一个自己建立的过滤器，例如之前建立的名字为test的过滤器。也可以选择Omnipeek自带的过滤器。    
![选择一个自己建立的过滤器](https://github.com/gaheadus/daily_use/blob/master/Resources/%E9%80%89%E6%8B%A9%E4%B8%80%E4%B8%AA%E8%87%AA%E5%B7%B1%E5%BB%BA%E7%AB%8B%E7%9A%84%E8%BF%87%E6%BB%A4%E5%99%A8.png)    
注意，如果想切换过滤器，比如当前显示的是management类型包，现在想显示control类型包，则必须先在过滤器上选择All Packets，之后再选择control过滤器。如果没有先在过滤器上选择All Packets这个步骤，则过滤出来的包为空，也就是说之后选择的过滤器是应用在先前已选过滤之上，是二次过滤。    
[*返回omnipeek*](#omnipeek)    

#### 过滤器条使用    
filter('test')或filter('test2') //test和test2就是之前新建的过滤器的名字。大小写不敏感。    
过滤条输入过滤条件，按回车键，或者鼠标点击右边三角形按钮，应用过滤条件。效果和之前鼠标选择过滤条件是一样的。    

也可以使用Omnipeek自带的过滤器，如dhcp、802.11 control等等，如下：    
filter('DHCP')或filter('dhcp')、filter('802.11 control')、filter('802.11 beacons)。    

或者，直接编写过滤条件，如下：    
mac地址过滤，    
addr(type:wireless,addr1:90.B6.86.80.93.24,addr2:40.45.DA.AA.99.FE) //注意mac地址中间用点号,不能用冒号(语法冲突)    
addr(type:wireless,addr1:90B686809324,addr2:4045DAAA99FE) //或者，直接写十六进制mac地址，中间不加任何符号    
addr(type:wireless,addr1:90.B6.86.80.93.24,addr2:40.45.DA.AA.99.FE,dir:1to2) //还可以设定addr1-addr2之间的方向，1to2、2to1、both(默认)，默认both。    
备注:2to1不能用，软件bug，只能将addr2、addr1位置对调，仍然使用1to2，如下：    
addr(type:wireless,addr2:90.B6.86.80.93.24,addr1:40.45.DA.AA.99.FE,dir:1to2)    

使用通配符：    
addr(type:wireless,addr1:'90.B6.86.80.93.\*',addr2:40.45.DA.AA.99.FE) //有通配符\*时需要加单引号，没有通配符时单引号可加可不加。    
addr(type:wireless,addr1:'90.B6.86.\*.\*.\*',addr2:40.45.DA.AA.99.FE)    
addr(type:wireless,addr1:'90.B6.\*.\*.\*.\*',addr2:40.45.DA.AA.99.FE)    

bssid过滤：    
wireless(bssid:90.B6.86.80.93.24)    
bssid过滤 & mac地址过滤：    
addr(type:wireless,addr1:90.B6.86.80.93.24,addr2:40.45.DA.AA.99.FE) & wireless(bssid:90.B6.86.80.93.24)    

广播mac地址：    
addr(type:wireless,addr1:90.B6.86.80.93.24,addr2:ff.ff.ff.ff.ff.ff)     
addr(type:wireless,addr1:90B686809324,addr2:ffffffffffff)     

ip地址过滤：    
addr(ip:255.255.255.255)或者addr(ip:'255.255.255.\*') //有通配符\*时需要加单引号，没有通配符时单引号可加可不加。    
ip(255.255.255.255)或者ip('255.255.255.\*') //直接使用ip函数就可以    

更多：    
addr(ethernet:'3com:\*.\*.\*')、addr(type: ip, addr1: 10.4.3.1, addr2: 10.5.1.1, dir: 1to2)    

过滤条，其实就是将之前使用鼠标点击操作，转化为纯文本操作了。    

过滤条语法，参考帮助文档。    
[*返回omnipeek*](#omnipeek)  &emsp;&emsp;&emsp;&emsp;  [*返回目录*](#工具与使用)    



## wireshark  
### wireshark怎么抓包  
[*返回目录*](#工具与使用)  
原文：https://blog.csdn.net/u013258415/article/details/77877746  
在windows平台中，有两个wireshark的图标，一个是wireshark(中文版）；另外一个是wireshark legacy （英文版）。  
在这里我们选择wireshark(中文版)，英文版的参考我这个区域中其他的blog  
**设置捕获接口**  
![设置捕获接口](https://github.com/gaheadus/daily_use/blob/master/Resources/wireshark%E8%AE%BE%E7%BD%AE%E6%8D%95%E8%8E%B7%E6%8E%A5%E5%8F%A3.png)  
**停止与重新监听**  
![停止与重新监听](https://github.com/gaheadus/daily_use/blob/master/Resources/wireshark%E5%81%9C%E6%AD%A2%E4%B8%8E%E9%87%8D%E6%96%B0%E7%9B%91%E5%90%AC.png)  
**数据包的保存**  
完成数据包的捕获后，可能我们并不急着马上做分析，或者说当前能做的分析还不够完整，需要后面来加深……如此种种，我们需要用文件保存这些数据包。保存数据包也有三种方式，  
1 使用Ctrl+S组合键；  
2 菜单栏：依次点击"File"-->"Save"  
3 主工具栏 的按钮  
![数据包的保存](https://github.com/gaheadus/daily_use/blob/master/Resources/wireshark%E6%95%B0%E6%8D%AE%E5%8C%85%E7%9A%84%E4%BF%9D%E5%AD%98.png)  
[*返回wireshark*](#wireshark) &emsp;&emsp;&emsp;&emsp;  [*返回目录*](#工具与使用)  

### wireshark常用选项与功能总结  
参考：https://blog.csdn.net/lhorse003/article/details/71758019  
[*返回wireshark*](#wireshark) &emsp;&emsp;&emsp;&emsp;  [*返回目录*](#工具与使用)  



## iperf  
[iperf介绍](#iperf介绍)  &emsp;&emsp;&emsp;&emsp;  [iperf使用](#iperf使用)  &emsp;&emsp;&emsp;&emsp;  [参数说明](#参数说明)  &emsp;&emsp;&emsp;&emsp;  [参考网址](#参考网址)  
[*返回目录*](#工具与使用)  

### iperf介绍
**iperf官网**  
iperf下载：https://iperf.fr/    
iperf不需要安装，当需要用iperf来测试网络中两个结点间的带宽时，只需把iperf.exe文件分别copy到这两台计算机的硬盘中。使用时，直接在命令行窗口中运行带各种参数的iperf命令即可。    

**iperf介绍**  
iperf是一个网络性能测试工具，它拥有多个参数，可以测量TCP和UDP的带宽，延时抖动以及丢包率。    
带宽测试通常采用UDP模式，因为能测出极限带宽、时延抖动、丢包率。在进行测试时，首先以链路理论带宽作为数据发送速率进行测试，例如，从客户端到服务器之间的链路的理论带宽为100Mbps，先用-b 100M进行测试，然后根据测试结果（包括实际带宽，时延抖动和丢包率），再以实际带宽作为数据发送速率进行测试，会发现时延抖动和丢包率比第一次好很多，重复测试几次，就能得出稳定的实际带宽。    


### iperf使用
**TCP模式**    
服务器端：iperf -s    
客户端：iperf -c 192.168.1.1 -t 60    
在tcp模式下，客户端到服务器192.168.1.1上传带宽测试，测试时间为60秒。    
iperf -c 192.168.1.1 -P 30 -t 60    
客户端同时向服务器端发起30个连接线程。    
iperf -c 192.168.1.1 -d -t 60    
进行上下行带宽测试。  

**UDP模式**    
服务器端：iperf -u -s    
客户端：iperf -u -c 192.168.1.1 -b 100M -t 60    
在udp模式下，以100Mbps为数据发送速率，客户端到服务器192.168.1.1上传带宽测试，测试时间为60秒。    
iperf -u -c 192.168.1.1 -b 5M -P 30 -t 60    
客户端同时向服务器端发起30个连接线程，以5Mbps为数据发送速率。    
iperf -u -c 192.168.1.1 -b 100M -d -t 60    
以100M为数据发送速率，进行上下行带宽测试。  

> 备注：从客户端向服务器端发送数据，对于客户端来说是上行，对于服务器端来说是下行。因此，对于某个设备，如果想要测试设备的上行速率，那么设备应该作为客户端，如果要测试设备的下行速率，那么设备应该作为服务器端。

[*返回iperf*](#iperf)  &emsp;&emsp;&emsp;&emsp;  [*返回目录*](#工具与使用)  


### 参数说明  
**iperf常用参数**  
-s 以server模式启动，默认是TCP方式，eg：iperf -s    
  -c host以client模式启动，host是server端ip地址，eg：iperf -c 10.1.1.2     
Note: 这里的server和client的概念跟我们在应用层的理解是相反的。举个例子，LAN和WAN之间，下行数据，我们通常会认为WAN端是server，LAN端是client. 在iperf中，如果测试下行速率，则是把WAN端作为client，LAN端作为Server.这个一定要记住。    
  -t 测试时间，默认10秒, eg：iperf -c 10.1.1.2 -t 100    
  -w 指定窗口大小，默认是8KB    
  -i sec 以秒为单位间隔显示报告，eg：iperf -c 10.1.1.2 -i 2    
  -u 使用udp协议    
  -b 指定bindwidth，仅适用于UDP，默认是1Mbit/sec    
  -l 缓冲区大小，默认是8KB, iperf -c 10.1.1.2 -l 1000    
Note：此值在测试UDP时非常重要，如果太小，将导致CFM hang up，如果太大，将导致UDP分片出错，CPE会频繁Down掉。建议此值在800-1200之间。（通过抓包可以看出包的大小）.     
  -n 指定传输的字节数，eg：iperf -c 10.1.1.2 -n 100000    
  -p 指定服务器端或客户端所连接的端口 eg：iperf -s -p 9999;  iperf -c 10.1.1.2 -p 9999    
[*返回iperf*](#iperf)  &emsp;&emsp;&emsp;&emsp;  [*返回目录*](#工具与使用)  


**iperf参数详解**  
![iperf参数详解1](https://github.com/gaheadus/daily_use/blob/master/Resources/iperf%E5%8F%82%E6%95%B01.PNG)
![iperf参数详解2](https://github.com/gaheadus/daily_use/blob/master/Resources/iperf%E5%8F%82%E6%95%B02.PNG)
![iperf参数详解3](https://github.com/gaheadus/daily_use/blob/master/Resources/iperf%E5%8F%82%E6%95%B03.PNG)
![iperf参数详解4](https://github.com/gaheadus/daily_use/blob/master/Resources/iperf%E5%8F%82%E6%95%B04.PNG)
[*返回iperf*](#iperf)  &emsp;&emsp;&emsp;&emsp;  [*返回目录*](#工具与使用)  


### 参考网址
https://www.cnblogs.com/Kimura/p/7514634.html

[*返回iperf*](#iperf)  &emsp;&emsp;&emsp;&emsp;  [*返回目录*](#工具与使用)  






