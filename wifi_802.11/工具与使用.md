# 工具与使用
[omnipeek](#omnipeek)  &emsp;&emsp;  [wireshark](#wireshark)  &emsp;&emsp;  [iperf](#iperf)  


## omnipeek
//TODO  


## wireshark
//TODO  


## iperf
**TCP模式**  
服务器端：iperf -s  
客户端：iperf -c 192.168.1.1 -t 60  
在tcp模式下，客户端到服务器192.168.1.1上传带宽测试，测试时间为60秒。  
iperf -c 192.168.1.1 -P 30 -t 60  
客户端同时向服务器端发起30个连接线程。  
iperf -c 192.168.1.1 -d -t 60  
进行上下行带宽测试。

**UDP模式**  
服务器端：iperf -u -s  
客户端：iperf -u -c 192.168.1.1 -b 100M -t 60  
在udp模式下，以100Mbps为数据发送速率，客户端到服务器192.168.1.1上传带宽测试，测试时间为60秒。  
iperf -u -c 192.168.1.1 -b 5M -P 30 -t 60  
客户端同时向服务器端发起30个连接线程，以5Mbps为数据发送速率。  
iperf -u -c 192.168.1.1 -b 100M -d -t 60  
以100M为数据发送速率，进行上下行带宽测试。

**参数说明**  
  -s 以server模式启动，默认是TCP方式，eg：iperf -s  
  -c host以client模式启动，host是server端ip地址，eg：iperf -c 10.1.1.2   
Note: 这里的server和client的概念跟我们在应用层的理解是相反的。举个例子，LAN和WAN之间，下行数据，我们通常会认为WAN端是server，LAN端是client. 在iperf中，如果测试下行速率，则是把WAN端作为client，LAN端作为Server.这个一定要记住。  
  -t 测试时间，默认10秒, eg：iperf -c 10.1.1.2 -t 100  
  -w 指定窗口大小，默认是8KB  
  -i sec 以秒为单位间隔显示报告，eg：iperf -c 10.1.1.2 -i 2  
  -u 使用udp协议  
  -b 指定bindwidth，仅适用于UDP，默认是1Mbit/sec  
  -l 缓冲区大小，默认是8KB, iperf -c 10.1.1.2 -l 1000  
Note：此值在测试UDP时非常重要，如果太小，将导致CFM hang up，如果太大，将导致UDP分片出错，CPE会频繁Down掉。建议此值在800-1200之间。（通过抓包可以看出包的大小）.   
  -n 指定传输的字节数，eg：iperf -c 10.1.1.2 -n 100000  
  -p 指定服务器端或客户端所连接的端口 eg：iperf -s -p 9999;  iperf -c 10.1.1.2 -p 9999  

iperf是一个网络性能测试工具，它拥有多个参数，可以测量TCP和UDP的带宽，延时抖动以及丢包率。  
带宽测试通常采用UDP模式，因为能测出极限带宽、时延抖动、丢包率。在进行测试时，首先以链路理论带宽作为数据发送速率进行测试，例如，从客户端到服务器之间的链路的理论带宽为100Mbps，先用-b 100M进行测试，然后根据测试结果（包括实际带宽，时延抖动和丢包率），再以实际带宽作为数据发送速率进行测试，会发现时延抖动和丢包率比第一次好很多，重复测试几次，就能得出稳定的实际带宽。  

iperf下载：https://iperf.fr/  
iperf不需要安装，当需要用iperf来测试网络中两个结点间的带宽时，只需把iperf.exe文件分别copy到这两台计算机的硬盘中。使用时，直接在命令行窗口中运行带各种参数的iperf命令即可。  
[*返回目录*](#工具与使用)






